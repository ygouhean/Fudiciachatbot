<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chatbot Interface</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .page{
            padding: 30px;
            padding-left: 800px;
            padding-right: 800px;
        }
        /* Custom CSS for Chatbot */
        .main-container {
            box-shadow: ;
            border: 20px solid black;
            border-radius: 60px;
            display: flex;
            flex-direction: column;
            height: 800px;
            width: 450px;
            padding: 5px;
        }
        .torch-container{
            display: flex;
            background-color: black;
            border-radius: 50px;
            height: 50px;
            width: 200px;
            margin-left: 100px;
        }
        .chat-container {
            flex: 1;
            border: 1px solid #ddd;
            border-radius: 22px;
            overflow: hidden;
            height: 700px;
            display: flex;
            flex-direction: column;
            margin-top: 10px;
        }
        .chat-header {
            background-color: #007bff;
            color: white;
            padding: 10px;
            text-align: center;
            font-size: 18px;
        }
        .chat-messages {
            flex: 1;
            padding: 10px;
            overflow-y: auto;
            background-color: #f9f9f9;
        }
        .message {
            margin-bottom: 10px;
            padding: 8px 12px;
            border-radius: 5px;
            max-width: 70%;
        }
        .message.user {
            background-color: #007bff;
            color: white;
            margin-left: auto;
        }
        .message.bot {
            background-color: #e9ecef;
            color: black;
            margin-right: auto;
        }
        .chat-input {
            display: flex;
            border-top: 1px solid #ddd;
            background-color: white;
        }
        .chat-input input {
            flex: 1;
            border: none;
            padding: 10px;
            outline: none;
        }
        .chat-input button {
            border: none;
            background-color: #007bff;
            color: white;
            padding: 10px 20px;
            cursor: pointer;
        }
        /* Style pour l'image */
        .user-profile {
            text-align: center;
            margin-left: 20px; /* Espacement entre le chatbot et l'image */
        }
        .user-profile img {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            border: 3px solid #007bff;
        }
        .user-profile span {
            display: block;
            margin-top: 10px;
            font-size: 18px;
            font-weight: bold;
        }
    </style>
</head>
<body>
  <section class="page">
        <div class="main-container">
         <!-- Torch Container -->    
         <div class="torch-container"></div>
        <!-- Chatbot Container -->
        <div class="chat-container">
     
            <!-- Chat Header -->
            <div class="chat-header">
            <!-- Nouvelle div pour l'image à droite -->
            <div class="user-profile">
             <img src="fudicia.jpg" alt="votre assureur santé FudicIA">
             <span>Votre Assureur santé</span>
            </div>
                <h1><strong>FudicIA</strong></h1> 
            </div>

            <!-- Chat Messages -->
            <div class="chat-messages" id="chat-messages">
                <div class="message bot">Bonjour ! Comment puis-je vous aider aujourd'hui ?</div>
                <div class="message user">Salut, je cherche des informations sur mon assurance.</div>
            </div>

            <!-- Chat Input -->
            <div class="chat-input">
                <input type="text" id="chat-input" placeholder="Tapez votre message...">
                <button onclick="sendMessage()">Envoyer</button>
            </div>
        </div>

        <!-- Nouvelle div pour l'image à droite
        <div class="user-profile">
            <img src="img/topo content.png" alt="Ingénieur topographie">
            <span>Ingénieur Yannick</span>
        </div> -->
    </div>
</section>

    <!-- Bootstrap JS (optional)
    <script src="https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${GEMINI_API_KEY}"></script>  -->
    
    <script type="module">
      // Importer le SDK Google Generative AI
      import { GoogleGenerativeAI } from "https://esm.run/@google/generative-ai";
    
      // Configuration de l'API
      const API_KEY = "AIzaSyDwwx8UMHhSHLPTnBzDTJJvgut9GXYUuFE"; // Remplacez par votre clé API
      const genAI = new GoogleGenerativeAI(API_KEY);
    
      // Sélectionner le modèle (par exemple, "gemini-1.5-flash")
      const model = genAI.getGenerativeModel({ model: "gemini-1.5-flash" });
    
      // Prompt pour spécialiser le bot en topographie
      const prompt = `
        Tu es un expert en assurance santé. Tu peux aider les utilisateurs à :
        1. Faire une réclamation et suivre leur remboursement.
        2. Trouver un centre médical partenaire.
        3. Répondre aux questions sur les garanties et remboursements.
        4. Envoyer des rappels pour des documents ou des rendez-vous médicaux.

        Si une question est hors de ce domaine, informe l'utilisateur poliment.
        `;
    
      // Fonction pour envoyer un message à l'API et obtenir une réponse
      async function sendMessage() {
        const input = document.getElementById("chat-input");
        const message = input.value.trim();
    
        if (message !== "") {
          const chatMessages = document.getElementById("chat-messages");
    
          // Ajouter le message de l'utilisateur à l'interface
          chatMessages.innerHTML += `<div class="message user">${message}</div>`;
    
          // Effacer l'input
          input.value = "";
    
          // Combiner le prompt et le message de l'utilisateur
          const fullPrompt = `${prompt}\n\nUtilisateur : ${message}`;
    
          // Appeler l'API Google Generative AI
          try {
            const result = await model.generateContent(fullPrompt);
            const response = await result.response;
            const text = response.text();
    
            // Ajouter la réponse du bot à l'interface
            chatMessages.innerHTML += `<div class="message bot">${text}</div>`;
          } catch (error) {
            console.error("Erreur lors de la génération de la réponse :", error);
            chatMessages.innerHTML += `<div class="message bot">Désolé, une erreur s'est produite. Veuillez réessayer.</div>`;
          }
    
          // Faire défiler vers le bas pour afficher le nouveau message
          chatMessages.scrollTop = chatMessages.scrollHeight;
        }
      }
    
      // Associer la fonction sendMessage au bouton "Envoyer"
      document.querySelector(".chat-input button").addEventListener("click", sendMessage);
    
      // Permettre d'envoyer un message en appuyant sur "Entrée"
      document.getElementById("chat-input").addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          sendMessage();
        }
      });
    </script>
</body>
</html>
